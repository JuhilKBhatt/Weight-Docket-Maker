<!DOCTYPE html>
<html lang="en">
<head>
    <title>Docket {{ docket.scrdkt_number }}</title>
    <meta charset="UTF-8">
    <style>
        {{ css_content }}
    </style>
</head>
<body>

    <table class="header-layout-table">
        <tr>
            <td rowspan="2" class="title-cell" style="width: 60%;">
                {% if docket.docket_type == 'Weight' %}
                    <h1>Weight Docket</h1>
                {% else %}
                    <h1>Purchase Receipt</h1>
                {% endif %}
            </td>
            
            <td style="width: 40%;">
                <div class="docket-id">ID #: {{ docket.scrdkt_number }}</div>
            </td>
        </tr>
        <tr>
            <td>
                <div class="sub-info">Date: {{ formatted_date }} | {{docket.docket_time}}</div>
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <div class="company-block-container">
                    {% if recycling_icon %}
                        <div>
                            <img src="data:image/png;base64,{{ recycling_icon }}" class="company-logo" alt="Logo" />
                        </div>
                    {% endif %}

                    <div class="company-text">
                        <h2>{{ docket.company_name or "SAFARI COPPER RECYCLING" }}</h2>
                        <div class="sub-info">
                            Address: 4 Tarlington Pl, Smithfield, NSW, 2164 <br>
                            ABN: 93 686 008 640 | Phone No: 0411 499 553 | 
                            Email: smithfield.scrap@gmail.com
                        </div>
                    </div>
                </div>
            </td>
        </tr>
    </table>

    <div class="customer-section">
        <div>
            <strong>Customer Name:</strong> {{ docket.customer_name }}
        </div>
        <div class="other-info-box">
            <strong>Other Information:</strong>
            
            <span class="other-info-label">DOB:</span>
            <span class="other-info-val">{{ docket.customer_dob or '' }}</span>|
            
            <span class="other-info-label">License No.:</span>
            <span class="other-info-val">{{ docket.customer_license_no }}</span>|
            
            <span class="other-info-label">Rego No.:</span>
            <span class="other-info-val">{{ docket.customer_rego_no }}</span>|
            
            <span class="other-info-label">PayID:</span>
            <span class="other-info-val">{{ docket.customer_pay_id }}</span>|
            
            <span class="other-info-label">Phone No.:</span>
            <span class="other-info-val">{{ docket.customer_phone }}</span>|
            
            <span class="other-info-label">ABN:</span>
            <span class="other-info-val">{{ docket.customer_abn }}</span>|
            
            <span class="other-info-label">BSB:</span>
            <span class="other-info-val">{{docket.bank_bsb}}</span>|
            
            <span class="other-info-label">Acc No.:</span>
            <span class="other-info-val">{{ docket.bank_account_number }}</span>|
            
            <span class="other-info-label">Address:</span>
            <span class="other-info-val">{{docket.customer_address}}</span>|
            
            <span class="other-info-label">Notes:</span>
            <span class="other-info-val">{{ docket.notes }}</span>
        </div>
    </div>

    <table class="data-table">
        <thead>
            <tr>
                <th style="width: 6%; text-align: center;">#</th>
                <th style="width: 18%; text-align: center;">Metal</th>
                <th style="width: 20%; text-align: center;">Notes</th>
                <th style="width: 12%; text-align: center;">Gross</th>
                <th style="width: 12%; text-align: center;">Tare</th>
                <th style="width: 12%; text-align: center;">Net</th>
                <th style="width: 8%; text-align: center;">$/kg</th>
                <th style="width: 12%; text-align: center;">Total</th>
            </tr>
        </thead>
        <tbody>
            {% for item in items %}
            <tr>
                <td style="text-align: center;">{{ loop.index }}</td>
                <td>{{ item.metal }}</td>
                <td>{{ item.notes or '' }}</td>
                <td>{{ "{:,.0f}".format(item.gross) }}kg</td>
                <td>{{ "{:,.0f}".format(item.tare) }}kg</td>
                <td><strong>{{ "{:,.0f}".format(item.net) }}kg</strong></td>
                <td>${{ "{:,.2f}".format(item.price) }}</td>
                <td>${{ "{:,.2f}".format(item.total) }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="totals-section">    
        {% if pre_deductions %}
             <div style="font-size: 10pt; font-weight: normal;">Items Total: ${{ "{:,.2f}".format(totals.itemsTotal) }}</div>
             {% for d in pre_deductions %}
                <div style="font-size: 8pt; font-weight: normal; color: #b01c2e;">{{ d.label }}: -${{ "{:,.2f}".format(d.amount) }}</div>
             {% endfor %}
             <div style="font-size: 8pt; font-weight: bold; border-top: 1px solid #ccc; display: inline-block; margin-top: 2px; padding-top: 2px;">Subtotal: ${{ "{:,.2f}".format(totals.grossTotal) }}</div>
        {% else %}
             {% if docket.include_gst %}
                <div style="font-size: 10pt; font-weight: normal;">Subtotal: ${{ "{:,.2f}".format(totals.grossTotal) }}</div>
             {% endif %}
        {% endif %}

        {% if docket.include_gst %}
            <div style="font-size: 8pt; font-weight: normal;">GST {{docket.gst_percentage}}%: ${{ "{:,.2f}".format(totals.gstAmount) }}</div>
        {% endif %}

        {% for d in post_deductions %}
            <div style="font-size: 8pt; font-weight: normal; color: #b01c2e;">{{ d.label }}: -${{ "{:,.2f}".format(d.amount) }}</div>
        {% endfor %}
        <div style="margin-top: 8px; font-size: 12pt;">Total: ${{ "{:,.2f}".format(totals.finalTotal) }}</div>
    </div>

    <div class="footer-section">
        <div style="text-align: center;">
            <div class="signature-line"></div>
            <div> Staff + Customer Signature</div>
        </div>
    </div>
</body>
</html>