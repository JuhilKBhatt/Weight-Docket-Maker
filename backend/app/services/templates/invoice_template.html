<!DOCTYPE html>
<html lang="en">
<head>
    <title>Invoice {{ invoice.scrinv_number }}</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        {{ css_content }}
    </style>
</head>
<body class="content-wrapper">
<img src="data:image/png;base64,{{ header_img_base64 }}" class="full-width-img" alt="Header" />
<br>
    <table class="layout">
        <tr>
            <td style="width: 40%; vertical-align: top;">
                <div class="address-block">
                    <div class="section-label">BILL FROM</div>
                    <div style="margin-top: 5px;">
                        <strong> {{ invoice.bill_from_name }}</strong><br>
                        Address: {{ invoice.bill_from_address }}<br>
                        Phone: {{ invoice.bill_from_phone }}<br>
                        Email: {{ invoice.bill_from_email }}<br>
                        ABN: {{ invoice.bill_from_abn }}
                    </div>
                </div>
            </td>
            <td style="width: 40%; vertical-align: top;">    
                <div class="address-block">
                    <div class="section-label">BILL TO</div>
                    <div style="margin-top: 5px;">
                        <strong> {{ invoice.bill_to_name }}</strong><br>
                        Address: {{ invoice.bill_to_address }}<br>
                        Phone: {{ invoice.bill_to_phone }}<br>
                        Email: {{ invoice.bill_to_email }}<br>
                        ABN: {{ invoice.bill_to_abn }}
                    </div>
                </div>
            </td>
            <td style="width: 20%; text-align: right; vertical-align: top;">
                <table style="width: 100%; margin-top: 40px;">
                    <tr>
                        <td class="invoice-number-row">INVOICE ID#:{{ invoice.scrinv_number }}</td>
                    </tr>
                    <tr>
                        <td class="invoice-date">DATE: {{ formatted_date }}</td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
    <table class="items-table">
        <thead>
            <tr>
                {% if invoice.invoice_type == 'Container' %}
                    <th style="width: 15%;">Seal #</th>
                    <th style="width: 15%;">Container #</th>
                    <th style="width: 30%;">Description</th>
                    <th style="width: 15%;" class="text-right">Quantity</th>
                    <th style="width: 10%;" class="text-right">Price</th>
                    <th style="width: 15%;" class="text-right">Total</th>

                {% elif invoice.invoice_type == 'Pickup' %}
                    <th style="width: 5%;">#</th>
                    <th style="width: 25%;">Metal</th>
                    <th style="width: 30%;">Description</th>
                    <th style="width: 15%;" class="text-right">Quantity</th>
                    <th style="width: 10%;" class="text-right">Price</th>
                    <th style="width: 15%;" class="text-right">Total</th>

                {% else %} 
                    <th style="width: 50%;">Description</th>
                    <th style="width: 15%;" class="text-right">Quantity</th>
                    <th style="width: 15%;" class="text-right">Unit Price</th>
                    <th style="width: 20%;" class="text-right">Total</th>
                {% endif %}
            </tr>
        </thead>
        <tbody>
            {% for item in invoice.line_items %}
            <tr>
                {% if invoice.invoice_type == 'Container' %}
                    <td>{{ item.seal }}</td>
                    <td>{{ item.container_number }}</td>
                    <td>{{ item.description }}</td>
                    <td class="text-right">{{ item.quantity }} {{ item.unit }}</td>
                    <td class="text-right">{{ symbol }}{{ "{:,.2f}".format(item.price) }}</td>
                    <td class="text-right">{{ symbol }}{{ "{:,.2f}".format(item.quantity * item.price) }}</td>

                {% elif invoice.invoice_type == 'Pickup' %}
                    <td>{{ loop.index }}</td>
                    <td>{{ item.metal }}</td>
                    <td>{{ item.description }}</td>
                    <td class="text-right">{{ item.quantity }} {{ item.unit }}</td>
                    <td class="text-right">{{ symbol }}{{ "{:,.2f}".format(item.price) }}</td>
                    <td class="text-right">{{ symbol }}{{ "{:,.2f}".format(item.quantity * item.price) }}</td>

                {% else %} 
                    <td>{{ item.description }}</td>
                    <td class="text-right">{{ item.quantity }} {{ item.unit }}</td>
                    <td class="text-right">{{ symbol }}{{ "{:,.2f}".format(item.price) }}</td>
                    <td class="text-right">{{ symbol }}{{ "{:,.2f}".format(item.quantity * item.price) }}</td>
                {% endif %}
            </tr>
            {% endfor %}

            {% for trans in invoice.transport_items %}
            <tr>
                {% if invoice.invoice_type == 'Container' %}
                    <td colspan="2">Transport</td>
                    <td>{{ trans.name }}</td>
                    <td class="text-right">{{ trans.num_of_ctr }}</td>
                    <td class="text-right">{{ symbol }}{{ "{:,.2f}".format(trans.price_per_ctr) }}</td>
                    <td class="text-right">{{ symbol }}{{ "{:,.2f}".format(trans.num_of_ctr * trans.price_per_ctr) }}</td>

                {% elif invoice.invoice_type == 'Pickup' %}
                    <td></td>
                    <td>Transport</td>
                    <td>{{ trans.name }}</td>
                    <td class="text-right">{{ trans.num_of_ctr }}</td>
                    <td class="text-right">{{ symbol }}{{ "{:,.2f}".format(trans.price_per_ctr) }}</td>
                    <td class="text-right">{{ symbol }}{{ "{:,.2f}".format(trans.num_of_ctr * trans.price_per_ctr) }}</td>

                {% else %}
                    <td>Transport:{{ trans.name }}</td>
                    <td class="text-right">{{ trans.num_of_ctr }}</td>
                    <td class="text-right">{{ symbol }}{{ "{:,.2f}".format(trans.price_per_ctr) }}</td>
                    <td class="text-right">{{ symbol }}{{ "{:,.2f}".format(trans.num_of_ctr * trans.price_per_ctr) }}</td>
                {% endif %}
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <table class="layout" style="margin-top: 10px;">
        <tr>
            <td style="width: 60%; vertical-align: top;">
                <div style="margin-top: 10px;"></div>

                {% if invoice.notes %}
                <div style="margin-top: 15px; font-size: 14pt; border: 1px solid #ccc; padding: 10px;">
                    <strong>Notes:</strong><br>
                    {{ invoice.notes }}
                </div>
                {% endif %}
            </td>

            <td style="width: 5%;"></td>
            <td style="width: 35%; vertical-align: top;">
                <table class="totals-table">
                    {% for d in invoice.pre_gst_deductions %}
                    <tr>
                        <td class="text-right text-danger deduction-cell">{{ d.label }}:</td>
                        <td class="text-right text-danger deduction-cell">-{{ symbol }}{{ "{:,.2f}".format(d.amount) }}</td>
                    </tr>
                    {% endfor %}

                    <tr>
                        <td class="text-right bold subtotal-cell">SUB-TOTAL:</td>
                        <td class="text-right subtotal-cell" style="width: 100px;">{{ symbol }}{{ "{:,.2f}".format(totals.subtotal) }}</td>
                    </tr>

                    {% if invoice.include_gst %}
                    <tr>
                        <td class="text-right bold gst-cell">GST (10%):</td>
                        <td class="text-right gst-cell">{{ symbol }}{{ "{:,.2f}".format(totals.gst) }}</td>
                    </tr>
                    {% endif %}

                    {% for d in invoice.post_gst_deductions %}
                    <tr>
                        <td class="text-right text-danger deduction-cell">{{ d.label }}:</td>
                        <td class="text-right text-danger deduction-cell">-{{ symbol }}{{ "{:,.2f}".format(d.amount) }}</td>
                    </tr>
                    {% endfor %}

                    <tr>
                        <td class="text-right grand-total">TOTAL:</td>
                        <td class="text-right grand-total">{{ symbol }}{{ "{:,.2f}".format(totals.total) }}</td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
    <br>

    <table style="width: 100%; border-collapse: collapse; margin-top: 30px;">
        <tr>
            <td style="width: 68%; vertical-align: top;">
                <div class="box-header">PAYMENT ADVICE</div>
                <table class="footer-table">
                    <tr>
                        <td class="footer-label">Bank:</td>
                        <td class="footer-value">{{ invoice.bank_name }}</td>
                    </tr>
                    <tr>
                        <td class="footer-label">Account:</td>
                        <td class="footer-value">{{ invoice.account_name }}</td>
                    </tr>
                    <tr>
                        <td class="footer-label">BSB:</td>
                        <td class="footer-value">{{ invoice.bsb }}</td>
                    </tr>
                    <tr>
                        <td class="footer-label">Acc No:</td>
                        <td class="footer-value">{{ invoice.account_number }}</td>
                    </tr>
                </table>
            </td>

            <td style="width: 2%;"></td>
            <hr class="dotted"></hr>
            <td style="width: 30%; vertical-align: top;">
                <div class="box-header">INVOICE SUMMARY</div>
                <table class="footer-table">
                    <tr>
                        <td class="footer-label">BILLED FROM:</td>
                        <td class="footer-value">{{ invoice.bill_from_name }}</td>
                    </tr>
                    <tr>
                        <td class="footer-label">BILLED TO:</td>
                        <td class="footer-value">{{ invoice.bill_to_name }}</td>
                    </tr>
                    <tr>
                        <td class="footer-label">INVOICE ID#:</td>
                        <td class="footer-value">{{ invoice.scrinv_number }}</td>
                    </tr>
                    <tr>
                        <td class="footer-label">DATE:</td>
                        <td class="footer-value">{{ formatted_date }}</td>
                    </tr>
                    <tr>
                        <td class="footer-label">TOTAL:</td>
                        <td class="footer-value"><strong>{{ symbol }}{{ "{:,.2f}".format(totals.total) }}</strong></td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
    <br>
    <br>
<img src="data:image/png;base64,{{ footer_img_base64 }}" class="full-width-img" alt="Footer" />
</body>
</html>