<!DOCTYPE html>
<html>
<head>
    <style>
        {{ css_content }}
    </style>
</head>
<body>
<div class="logo-text"></div>
<div class="header-title"></div>
    <table class="layout">
        <tr>
            <td width="40%" valign="top">
                <div class="address-block">
                    <div class="section-label">BILL FROM</div>
                    <div style="margin-top: 5px;">
                        <strong> {{ invoice.bill_from_name }}</strong><br>
                        Address: {{ invoice.bill_from_address }}<br>
                        Phone: {{ invoice.bill_from_phone }}<br>
                        Email: {{ invoice.bill_from_email }}<br>
                        ABN: {{ invoice.bill_from_abn }}
                    </div>
                </div>
            </td>
            <td width="40%" valign="top">    
                <div class="address-block">
                    <div class="section-label">BILL TO</div>
                    <div style="margin-top: 5px;">
                        <strong> {{ invoice.bill_to_name }}</strong><br>
                        Address: {{ invoice.bill_to_address }}<br>
                        Phone: {{ invoice.bill_to_phone }}<br>
                        Email: {{ invoice.bill_to_email }}<br>
                        ABN: {{ invoice.bill_to_abn }}
                    </div>
                </div>
            </td>
            <td width="20%" align="right" valign="top">
                <table style="width: 100%; margin-top: 40px;">
                    <tr>
                        <td class="invoice-number-row">INVOICE ID#:{{ invoice.scrinv_number }}</td>
                    </tr>
                    <tr>
                        <td class="invoice-date">Date: {{ formatted_date }}</td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
    <table class="items-table">
        <thead>
            <tr>
                {% if invoice.invoice_type == 'Container' %}
                    <th width="15%">Seal #</th>
                    <th width="15%">Container #</th>
                    <th width="30%">Description</th>
                    <th width="15%" class="text-right">Quantity</th>
                    <th width="10%" class="text-right">Price</th>
                    <th width="15%" class="text-right">Total</th>

                {% elif invoice.invoice_type == 'Pickup' %}
                    <th width="5%">#</th>
                    <th width="25%">Metal</th>
                    <th width="30%">Description</th>
                    <th width="15%" class="text-right">Quantity</th>
                    <th width="10%" class="text-right">Price</th>
                    <th width="15%" class="text-right">Total</th>

                {% else %} 
                    <th width="50%">Description</th>
                    <th width="15%" class="text-right">Quantity</th>
                    <th width="15%" class="text-right">Unit Price</th>
                    <th width="20%" class="text-right">Total</th>
                {% endif %}
            </tr>
        </thead>
        <tbody>
            {% for item in invoice.line_items %}
            <tr>
                {% if invoice.invoice_type == 'Container' %}
                    <td>{{ item.seal }}</td>
                    <td>{{ item.container_number }}</td>
                    <td>{{ item.description }}</td>
                    <td class="text-right">{{ item.quantity }} {{ item.unit }}</td>
                    <td class="text-right">{{ symbol }}{{ "{:,.2f}".format(item.price) }}</td>
                    <td class="text-right">{{ symbol }}{{ "{:,.2f}".format(item.quantity * item.price) }}</td>

                {% elif invoice.invoice_type == 'Pickup' %}
                    <td>{{ loop.index }}</td>
                    <td>{{ item.metal }}</td>
                    <td>{{ item.description }}</td>
                    <td class="text-right">{{ item.quantity }} {{ item.unit }}</td>
                    <td class="text-right">{{ symbol }}{{ "{:,.2f}".format(item.price) }}</td>
                    <td class="text-right">{{ symbol }}{{ "{:,.2f}".format(item.quantity * item.price) }}</td>

                {% else %} 
                    <td>{{ item.description }}</td>
                    <td class="text-right">{{ item.quantity }} {{ item.unit }}</td>
                    <td class="text-right">{{ symbol }}{{ "{:,.2f}".format(item.price) }}</td>
                    <td class="text-right">{{ symbol }}{{ "{:,.2f}".format(item.quantity * item.price) }}</td>
                {% endif %}
            </tr>
            {% endfor %}

            {% for trans in invoice.transport_items %}
            <tr>
                {% if invoice.invoice_type == 'Container' %}
                    <td colspan="2">Transport</td>
                    <td>{{ trans.name }}</td>
                    <td class="text-right">{{ trans.num_of_ctr }}</td>
                    <td class="text-right">{{ symbol }}{{ "{:,.2f}".format(trans.price_per_ctr) }}</td>
                    <td class="text-right">{{ symbol }}{{ "{:,.2f}".format(trans.num_of_ctr * trans.price_per_ctr) }}</td>

                {% elif invoice.invoice_type == 'Pickup' %}
                    <td></td>
                    <td>Transport</td>
                    <td>{{ trans.name }}</td>
                    <td class="text-right">{{ trans.num_of_ctr }}</td>
                    <td class="text-right">{{ symbol }}{{ "{:,.2f}".format(trans.price_per_ctr) }}</td>
                    <td class="text-right">{{ symbol }}{{ "{:,.2f}".format(trans.num_of_ctr * trans.price_per_ctr) }}</td>

                {% else %}
                    <td>Transport:{{ trans.name }}</td>
                    <td class="text-right">{{ trans.num_of_ctr }}</td>
                    <td class="text-right">{{ symbol }}{{ "{:,.2f}".format(trans.price_per_ctr) }}</td>
                    <td class="text-right">{{ symbol }}{{ "{:,.2f}".format(trans.num_of_ctr * trans.price_per_ctr) }}</td>
                {% endif %}
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <table class="layout" style="margin-top: 10px;">
        <tr>
            <td width="60%" valign="top">
                <div style="margin-top: 10px;"></div>

                {% if invoice.notes %}
                <div style="margin-top: 15px; font-size: 14pt; border: 1px solid #ccc; padding: 10px;">
                    <strong>Notes:</strong><br>
                    {{ invoice.notes }}
                </div>
                {% endif %}
            </td>

            <td width="5%"></td>
            <td width="35%" valign="top">
                <table class="totals-table">
                    <tr>
                        <td class="text-right bold subtotal-cell">Subtotal:</td>
                        <td class="text-right subtotal-cell" width="100">{{ symbol }}{{ "{:,.2f}".format(totals.subtotal) }}</td>
                    </tr>

                    {% for d in invoice.pre_gst_deductions %}
                    <tr>
                        <td class="text-right text-danger deduction-cell">{{ d.label }}:</td>
                        <td class="text-right text-danger deduction-cell">-{{ symbol }}{{ "{:,.2f}".format(d.amount) }}</td>
                    </tr>
                    {% endfor %}

                    {% if invoice.include_gst %}
                    <tr>
                        <td class="text-right bold gst-cell">GST (10%):</td>
                        <td class="text-right gst-cell">{{ symbol }}{{ "{:,.2f}".format(totals.gst) }}</td>
                    </tr>
                    {% endif %}

                    {% for d in invoice.post_gst_deductions %}
                    <tr>
                        <td class="text-right text-danger deduction-cell">{{ d.label }}:</td>
                        <td class="text-right text-danger deduction-cell">-{{ symbol }}{{ "{:,.2f}".format(d.amount) }}</td>
                    </tr>
                    {% endfor %}

                    <tr>
                        <td class="text-right grand-total">TOTAL:</td>
                        <td class="text-right grand-total">{{ symbol }}{{ "{:,.2f}".format(totals.total) }}</td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>

    <table style="width: 100%; border-collapse: collapse; margin-top: 30px;">
        <tr>
            <td width="68%" valign="top">
                <div class="box-header">PAYMENT ADVICE</div>
                <table class="footer-table">
                    <tr>
                        <td class="footer-label">Bank:</td>
                        <td class="footer-value">{{ invoice.bank_name }}</td>
                    </tr>
                    <tr>
                        <td class="footer-label">Account:</td>
                        <td class="footer-value">{{ invoice.account_name }}</td>
                    </tr>
                    <tr>
                        <td class="footer-label">BSB:</td>
                        <td class="footer-value">{{ invoice.bsb }}</td>
                    </tr>
                    <tr>
                        <td class="footer-label">Acc No:</td>
                        <td class="footer-value">{{ invoice.account_number }}</td>
                    </tr>
                </table>
            </td>

            <td width="2%"></td>
            <hr class="dotted"></hr>
            <td width="30%" valign="top">
                <div class="box-header">SUMMARY</div>
                <table class="footer-table">
                    <tr>
                        <td class="footer-label">Invoice #:</td>
                        <td class="footer-value">{{ invoice.scrinv_number }}</td>
                    </tr>
                    <tr>
                        <td class="footer-label">Date:</td>
                        <td class="footer-value">{{ formatted_date }}</td>
                    </tr>
                    <tr>
                        <td class="footer-label">Total:</td>
                        <td class="footer-value"><strong>{{ symbol }}{{ "{:,.2f}".format(totals.total) }}</strong></td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</body>
</html>